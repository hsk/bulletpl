bulletML(none,[
  eaction(top1,[
    fire(some(dirAbs(0)),some(spdAbs(0)),bulletRef('4way',[rand,rand])),
    actionRef('3way',[rand,rand]),
    wait(100)
  ]),
  eaction('3way',[
    repeat(200,[
      action([
        fire(some(dirSeq(123.7+ $1)),some(spdAbs((1+ $2*0.5)*(1+rank*rank*rank*rank))),bullet(none,none,[])),
        repeat(2,[
          action([
            fire(some(dirSeq(120)),some(spdAbs((1+ $2*0.5)*(1+rank*rank*rank*rank))),bullet(none,none,[]))
          ])
        ]),
        wait(8-rank*4)
      ])
    ])
  ]),
  ebullet('4way',bullet(none,none,[
    action([
      repeat(200,[
        action([
          fire(some(dirSeq(92.1+ $1)),some(spdAbs((0.8+ $2*0.8)*(1+rank*rank*rank*rank))),bullet(none,none,[])),
          repeat(3,[
            action([
              fire(some(dirSeq(90)),some(spdAbs((0.8+ $2*0.8)*(1+rank*rank*rank*rank))),bullet(none,none,[]))
            ])
          ]),
          wait(8-rank*4)
        ])
      ]),
      vanish
    ])
  ])),
  eaction(top5,[actionRef('5way',[rand,rand])]),
  eaction('5way',[
    repeat(200,[
      action([
        fire(some(dirSeq(78.7+ $1)),some(spdAbs((0.6+ $2*1.6)*(1+rank*rank*rank*rank))),bullet(none,none,[action([changeSpeed(spdRel(0),9999)])])),
        repeat(4,[
          action([
            fire(some(dirSeq(72)),some(spdAbs((0.6+ $2*1.6)*(1+rank*rank*rank*rank))),bullet(none,none,[action([changeSpeed(spdRel(0),9999)])]))
          ])
        ]),
        wait(8-rank*4)
      ])
    ])
  ]),
  eaction(top6,[actionRef('6way',[rand,rand])]),
  eaction('6way',[
    repeat(200,[
      action([
        fire(some(dirSeq(63.3+ $1)),some(spdAbs((0.6+ $2*0.9)*(1+rank*rank*rank*rank))),bullet(none,none,[
          action([
            wait(9999),
            fire(some(dirRel(0)),some(spdRel(0)),bullet(none,none,[action([vanish])]))
          ])
        ])),
        repeat(5,[
          action([
            fire(some(dirSeq(60)),some(spdAbs((0.6+ $2*0.9)*(1+rank*rank*rank*rank))),bullet(none,none,[
              action([
                wait(9999),
                fire(some(dirRel(0)),some(spdRel(0)),bullet(none,none,[action([vanish])]))
              ])
            ]))
          ])
        ]),
        wait(8-rank*4)
      ])
    ])
  ])
]).
