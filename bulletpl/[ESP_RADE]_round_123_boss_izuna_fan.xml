bulletML(vertical,[
  ebullet('Red',bullet(none,none,[action([])])),
  ebullet('Dummy',bullet(none,none,[action([vanish])])),
  eaction('Stop',[changeSpeed(spdAbs(0),1)]),
  eaction('XWay',[actionRef('XWayFan',[$1,$2,0])]),
  eaction('XWayFan',[
    repeat($1-1,[action([fire(some(dirSeq($2)),some(spdSeq($3)),bullet(none,none,[]))])])
  ]),
  eaction(fan,[
    wait(2),
    changeSpeed(spdAbs(100000),1),
    wait(1- $1),
    actionRef('Stop',[]),
    fire(some(dirAbs(180- $3- $1* $5)),some(spdAbs($2)),bullet(none,none,[])),
    actionRef('XWay',[$1,$4]),
    actionRef(fan,[$1-1,$2+0.1,$3,$4,$5])
  ]),
  eaction(top,[
    actionRef(fanMain,[11+rank*6,1,30,12-rank*4,2.5-rank]),
    actionRef(fanMain,[11+rank*6,1,- 20,- 12+rank*4,- 2.5+rank]),
    actionRef(fanMain,[13+rank*8,1,30,12-rank*4,2.3-rank]),
    actionRef(fanMain,[13+rank*8,1,- 20,- 12+rank*4,- 2.3+rank])
  ]),
  eaction(fanMain,[
    fire(some(dirAim(180)),some(spdAbs(0)),bullet(none,none,[action([actionRef(fan,[$1,$2,$3,$4,$5])])])),
    wait(90)
  ])
]).
