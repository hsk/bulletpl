bulletML(vertical,[
  top:action([
    repeat(10,[
      action([
        fire(dirAbs(180+18),spdAbs(3),bulletRef(bit,[1.7,30,- 144])),
        wait(15),
        fire(dirAbs(180-18),spdAbs(3),bulletRef(bit,[1.7,30,144])),
        wait(30)
      ])
    ]),
    wait(450)
  ]),
  bit:bullet(dirAim(0),spdAbs(1),[
    action([
      wait($2),
      changeSpeed(spdAbs(0),1),
      fire(dirRel($3),spdAbs($1),bulletRef(bit,[$1,$2*1.2,$3])),
      fire(dirSeq(0),spdAbs(0),bulletRef(nobit,[$1*(0.5+0.5* $rank)])),
      repeat(15,[action([fire(dirSeq(0),spdAbs($1),bulletRef(weak,[$2*1.2])),wait(2)])]),
      vanish
    ])
  ]),
  nobit:bullet(dirAim(0),spdAbs(1),[
    action([
      fire(dirAim(0),spdAbs($1),bullet(dirAim(0),spdAbs(1),[])),
      repeat(4,[
        action([fire(dirSeq(0),spdAbs($1),bullet(dirAim(0),spdAbs(1),[])),wait(2)])
      ]),
      vanish
    ])
  ]),
  weak:bullet(dirAim(0),spdAbs(1),[action([wait($1),vanish])])
]).
