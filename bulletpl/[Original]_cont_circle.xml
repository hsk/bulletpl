bulletML(vertical,[
  ebullet('Dummy',bullet(none,none,[action([vanish])])),
  eaction('XWay',[actionRef('XWayFan',[$1,$2,0])]),
  eaction('XWayFan',[
    repeat($1-1,[action([fire(some(dirSeq($2)),some(spdSeq($3)),bullet(none,none,[]))])])
  ]),
  ebullet(bit,bullet(none,none,[
    action([
      repeat(1,[
        action([
          accel(some(spdAbs(0)),some(spdAbs(2)),40),
          wait(40),
          fire(some(dirAbs(90* $1)),some(spdAbs(2)),bulletRef(bit,[$1])),
          accel(some(spdAbs(- 2* $1)),some(spdAbs(0)),40),
          fire(some(dirAim(0)),some(spdAbs(1.3)),bullet(none,none,[])),
          wait(40),
          accel(some(spdAbs(0)),some(spdAbs(- 2)),40),
          fire(some(dirAim(0)),some(spdAbs(1.3)),bullet(none,none,[])),
          wait(40),
          accel(some(spdAbs(2* $1)),some(spdAbs(0)),40),
          fire(some(dirAim(0)),some(spdAbs(1.3)),bullet(none,none,[])),
          wait(40),
          fire(some(dirAim(0)),some(spdAbs(1.3)),bullet(none,none,[]))
        ])
      ]),
      vanish
    ])
  ])),
  eaction(top,[
    repeat(2+rank*4,[
      action([
        fire(some(dirAbs(90)),some(spdAbs(2)),bulletRef(bit,[1])),
        fire(some(dirAbs(- 90)),some(spdAbs(2)),bulletRef(bit,[- 1])),
        wait(160 div (2+rank*4))
      ])
    ]),
    wait(200)
  ])
]).
