bulletML(vertical,[
  top:action([
    repeat(3,[
      action([fire(dirAbs(180),spdAbs(3),bulletRef(fastHanabi,[])),wait(110- $rank*60)])
    ])
  ]),
  fastFour:action([
    fire(dirSeq(5),spdAbs(2+ $rank),bullet(dirAim(0),spdAbs(1),[])),
    fire(dirSeq(- 10),spdAbs(2+ $rank),bullet(dirAim(0),spdAbs(1),[])),
    fire(dirSeq(15),spdAbs(1.5+ $rank),bullet(dirAim(0),spdAbs(1),[])),
    fire(dirSeq(- 20),spdAbs(1.5+ $rank),bullet(dirAim(0),spdAbs(1),[]))
  ]),
  slowFour:action([
    fire(dirSeq(5),spdAbs(1+ $rank*0.8),bullet(dirAim(0),spdAbs(1),[])),
    fire(dirSeq(- 10),spdAbs(1+ $rank*0.8),bullet(dirAim(0),spdAbs(1),[])),
    fire(dirSeq(15),spdAbs(0.7+ $rank*0.8),bullet(dirAim(0),spdAbs(1),[])),
    fire(dirSeq(- 20),spdAbs(0.7+ $rank*0.8),bullet(dirAim(0),spdAbs(1),[]))
  ]),
  fastHanabi:bullet(dirAim(0),spdAbs(1),[
    action([
      wait(15),
      fire(dirAim(0),spdAbs(2.5+ $rank),bullet(dirAim(0),spdAbs(1),[])),
      actionRef(fastFour,[]),
      repeat(16,[
        action([
          fire(dirSeq(32.5),spdAbs(2.5+ $rank),bullet(dirAim(0),spdAbs(1),[])),
          actionRef(fastFour,[])
        ])
      ]),
      fireRef(slowHanabi,[]),
      vanish
    ])
  ]),
  slowHanabi:fire(dirAim(0),spdAbs(1),bullet(dirAim(0),spdAbs(1),[
    action([
      fire(dirAbs(0),spdAbs(1.3+ $rank*0.8),bullet(dirAim(0),spdAbs(1),[])),
      actionRef(slowFour,[]),
      repeat(16,[
        action([
          fire(dirSeq(32.5),spdAbs(1.3+ $rank*0.8),bullet(dirAim(0),spdAbs(1),[])),
          actionRef(slowFour,[])
        ])
      ]),
      vanish
    ])
  ]))
]).
